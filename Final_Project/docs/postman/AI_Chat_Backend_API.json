{
	"info": {
		"_postman_id": "aichat-backend-phase4",
		"name": "AI Chat Backend API - Phase 4",
		"description": "Comprehensive test suite for Phase 4 backend controllers covering authentication, conversations, messages, and error scenarios",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Authentication",
			"item": [
				{
					"name": "1.1 Signup - Valid",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response has userId and username\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('userId');",
									"    pm.expect(jsonData).to.have.property('username');",
									"    pm.expect(jsonData.username).to.eql('testuser1');",
									"});",
									"",
									"pm.test(\"Response time is less than 2000ms\", function () {",
									"    pm.expect(pm.response.responseTime).to.be.below(2000);",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"testuser1\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/signup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"signup"
							]
						},
						"description": "Test valid user signup"
					},
					"response": []
				},
				{
					"name": "1.2 Signup - Duplicate Username",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Error format is correct\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('error');",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.error).to.eql('VALIDATION_ERROR');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"testuser1\",\n  \"password\": \"differentpassword\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/signup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"signup"
							]
						},
						"description": "Test signup with duplicate username"
					},
					"response": []
				},
				{
					"name": "1.3 Signup - Invalid Username (short)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"ab\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/signup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"signup"
							]
						},
						"description": "Test signup with username too short"
					},
					"response": []
				},
				{
					"name": "1.4 Signup - Invalid Username (special chars)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"test@user\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/signup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"signup"
							]
						},
						"description": "Test signup with invalid username characters"
					},
					"response": []
				},
				{
					"name": "1.5 Signup - Password Too Short",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"testuser2\",\n  \"password\": \"12345\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/signup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"signup"
							]
						},
						"description": "Test signup with password too short"
					},
					"response": []
				},
				{
					"name": "1.6 Login - Valid",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has userId and username\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('userId');",
									"    pm.expect(jsonData).to.have.property('username');",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    const response = pm.response.json();",
									"    pm.environment.set(\"userId\", response.userId);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"testuser1\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"login"
							]
						},
						"description": "Test valid login"
					},
					"response": []
				},
				{
					"name": "1.7 Login - Invalid Password",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 401\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"pm.test(\"Error code is INVALID_CREDENTIALS\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.error).to.eql('INVALID_CREDENTIALS');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"testuser1\",\n  \"password\": \"wrongpassword\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"login"
							]
						},
						"description": "Test login with wrong password"
					},
					"response": []
				},
				{
					"name": "1.8 Login - Non-existent User",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404\", function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test(\"Error code is USER_NOT_FOUND\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.error).to.eql('USER_NOT_FOUND');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"nonexistent\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/login",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"login"
							]
						},
						"description": "Test login with non-existent user"
					},
					"response": []
				}
			],
			"description": "Authentication endpoint tests"
		},
		{
			"name": "2. Conversations",
			"item": [
				{
					"name": "2.1 Create - With Title",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});",
									"",
									"pm.test(\"Response contains id, title, createdAt\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('id');",
									"    pm.expect(jsonData).to.have.property('title');",
									"    pm.expect(jsonData).to.have.property('createdAt');",
									"    pm.expect(jsonData.title).to.eql('My First Chat');",
									"});",
									"",
									"if (pm.response.code === 201) {",
									"    const response = pm.response.json();",
									"    pm.environment.set(\"conversationId\", response.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"My First Chat\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test creating conversation with title"
					},
					"response": []
				},
				{
					"name": "2.2 Create - Without Title",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 201\", function () {",
									"    pm.response.to.have.status(201);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test creating conversation without title"
					},
					"response": []
				},
				{
					"name": "2.3 Create - Missing Header",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400 or 401\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([400, 401]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Test\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test creating conversation without X-User-Id header"
					},
					"response": []
				},
				{
					"name": "2.4 Create - Invalid User ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "-1"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Test\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test creating conversation with invalid user ID"
					},
					"response": []
				},
				{
					"name": "2.5 List - Valid",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is an array\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test listing user conversations"
					},
					"response": []
				},
				{
					"name": "2.6 List - Empty Result",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is empty array\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array').that.is.empty;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "999999"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test listing conversations for user with no conversations"
					},
					"response": []
				},
				{
					"name": "2.7 Update Title - Valid",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Updated Chat Title\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/title",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"title"
							]
						},
						"description": "Test updating conversation title"
					},
					"response": []
				},
				{
					"name": "2.8 Update Title - Empty",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/title",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"title"
							]
						},
						"description": "Test updating title with empty string"
					},
					"response": []
				},
				{
					"name": "2.9 Update Title - Too Long",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"This is a very long title that exceeds the maximum allowed length of 200 characters and should fail validation because it is way too long and contains more than the allowed number of characters for a conversation title in the system\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/title",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"title"
							]
						},
						"description": "Test updating title with string exceeding 200 characters"
					},
					"response": []
				},
				{
					"name": "2.10 Delete - Valid",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}"
							]
						},
						"description": "Test deleting conversation"
					},
					"response": []
				},
				{
					"name": "2.11 Delete - Already Deleted",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404 or 200\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}"
							]
						},
						"description": "Test deleting already deleted conversation"
					},
					"response": []
				}
			],
			"description": "Conversation management endpoint tests"
		},
		{
			"name": "3. Messages",
			"item": [
				{
					"name": "3.1 Get - Empty Conversation",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is empty array\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array').that.is.empty;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test getting messages from empty conversation"
					},
					"response": []
				},
				{
					"name": "3.2 Get - Populated Conversation",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is array with messages\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test getting messages from populated conversation"
					},
					"response": []
				},
				{
					"name": "3.3 Get - Invalid ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404 or 400\", function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([400, 404]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations/99999/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"99999",
								"messages"
							]
						},
						"description": "Test getting messages with invalid conversation ID"
					},
					"response": []
				},
				{
					"name": "3.4 Get - Unauthorized Access",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 403\", function () {",
									"    pm.response.to.have.status(403);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "999"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test getting messages with unauthorized user"
					},
					"response": []
				},
				{
					"name": "3.5 Send - Valid",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response contains assistantMessage\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('assistantMessage');",
									"    pm.expect(jsonData.assistantMessage).to.have.property('role');",
									"    pm.expect(jsonData.assistantMessage.role).to.eql('assistant');",
									"    pm.expect(jsonData.assistantMessage).to.have.property('content');",
									"    pm.expect(jsonData.assistantMessage.content.length).to.be.above(0);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"text\": \"Hello, what is Java?\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test sending valid message"
					},
					"response": []
				},
				{
					"name": "3.6 Send - Empty Text",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"text\": \"\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test sending empty message"
					},
					"response": []
				},
				{
					"name": "3.7 Send - Too Long",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"text\": \"x\".repeat(4001)\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test sending message exceeding 4000 characters"
					},
					"response": []
				},
				{
					"name": "3.8 Send - Multiple Messages",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"text\": \"Tell me about Python\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test sending multiple messages in sequence"
					},
					"response": []
				},
				{
					"name": "3.9 Send - AI Error",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 500\", function () {",
									"    pm.response.to.have.status(500);",
									"});",
									"",
									"pm.test(\"Error code is AI_SERVICE_ERROR\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.error).to.eql('AI_SERVICE_ERROR');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"text\": \"Test message\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test AI service error (requires invalid GEMINI_API_KEY)"
					},
					"response": []
				}
			],
			"description": "Message endpoint tests"
		},
		{
			"name": "4. Error Scenarios",
			"item": [
				{
					"name": "4.1 Conversation Limit (50)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Error code is LIMIT_EXCEEDED\", function () {",
									"    const jsonData = pm.response.json();",
									"    pm.expect(jsonData.error).to.eql('LIMIT_EXCEEDED');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"title\": \"Test Conversation\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test conversation limit (requires 50 conversations already created)"
					},
					"response": []
				},
				{
					"name": "4.2 Message Limit (10,000)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"text\": \"Test message\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/conversations/{{conversationId}}/messages",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations",
								"{{conversationId}}",
								"messages"
							]
						},
						"description": "Test message limit (requires 10,000 messages already sent)"
					},
					"response": []
				},
				{
					"name": "4.3 DB Connection Failure",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 500\", function () {",
									"    pm.response.to.have.status(500);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-User-Id",
								"value": "{{userId}}"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/conversations",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"conversations"
							]
						},
						"description": "Test database connection failure (requires PostgreSQL to be stopped)"
					},
					"response": []
				},
				{
					"name": "4.4 Invalid JSON",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"test\",\n  \"password\": \n}"
						},
						"url": {
							"raw": "{{baseUrl}}/auth/signup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"signup"
							]
						},
						"description": "Test malformed JSON request"
					},
					"response": []
				},
				{
					"name": "4.5 Missing Request Body",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{baseUrl}}/auth/signup",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"auth",
								"signup"
							]
						},
						"description": "Test request with missing body"
					},
					"response": []
				}
			],
			"description": "Error scenario tests"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080/api/v1",
			"type": "string"
		}
	]
}

